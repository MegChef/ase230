---
marp: true
html: true
size: 4:3
paginate: true
style: |
  img[alt~="center"] {
    display: block;
    margin: 0 auto;
  }
    img[alt~="outline"] {
    border: 2px solid #388bee;
  }
  .columns {
    display: flex;
    gap: 2rem;
  }
  .column {
    flex: 1;
  }
---

<!-- _class: frontpage -->
<!-- _paginate: skip -->

# Create, Read, Update, and Delete (CRUD) DB Operations Using PDO

---

## Connection

```php
<?php
declare(strict_types=1);

// --- Database connection (PDO) ---
$servername = "localhost";
$username   = "root";
$password   = "123456"; // Your password
$dbname     = "studentdb";

try {
    $dsn = "mysql:host={$servername};dbname={$dbname};charset=utf8mb4";
    $options = [
        PDO::ATTR_ERRMODE            => PDO::ERRMODE_EXCEPTION, // throw exceptions
        PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
        PDO::ATTR_EMULATE_PREPARES   => false,                  // use native prepares
    ];
    $pdo = new PDO($dsn, $username, $password, $options);
    echo "Connected successfully<br><br>";
} catch (PDOException $e) {
    exit("Connection failed: " . htmlspecialchars($e->getMessage()));
}
```

---

## CREATE - Insert new student records

```php
echo "<h2>CREATE - Adding New Students</h2>";

try {
    $sql  = "INSERT INTO students (name, age, major) VALUES (:name, :age, :major)";
    $stmt = $pdo->prepare($sql);

    // 1) Alice Johnson
    $stmt->execute([
        ':name'  => "Alice Johnson",
        ':age'   => 22,
        ':major' => "Computer Science",
    ]);
    echo "Student 'Alice Johnson' added successfully<br>";

    // 2) Bob Smith
    $stmt->execute([
        ':name'  => "Bob Smith",
        ':age'   => 21,
        ':major' => "Mathematics",
    ]);
    echo "Student 'Bob Smith' added successfully<br>";

    echo "<br>";
} catch (PDOException $e) {
    echo "Error (CREATE): " . htmlspecialchars($e->getMessage()) . "<br><br>";
}
```

---

## READ - Display all student records

```php
echo "<h2>READ - All Students</h2>";

try {
    $sql    = "SELECT id, name, age, major FROM students";
    $rows   = $pdo->query($sql)->fetchAll();

    if ($rows && count($rows) > 0) {
        echo "Found " . count($rows) . " students:<br>";
        foreach ($rows as $row) {
            echo "ID: {$row['id']} - Name: {$row['name']} - Age: {$row['age']} - Major: {$row['major']}<br>";
        }
    } else {
        echo "No students found<br>";
    }
    echo "<br>";
} catch (PDOException $e) {
    echo "Error (READ all): " . htmlspecialchars($e->getMessage()) . "<br><br>";
}
```

---

### READ - Get specific student by ID

```php
echo "<h2>READ - Specific Student (ID = 1)</h2>";

try {
    $student_id = 1;
    $sql  = "SELECT id, name, age, major FROM students WHERE id = :id";
    $stmt = $pdo->prepare($sql);
    $stmt->execute([':id' => $student_id]);
    $row = $stmt->fetch();

    if ($row) {
        echo "Found student: {$row['name']} (Age: {$row['age']}, Major: {$row['major']})<br>";
    } else {
        echo "No student found with ID {$student_id}<br>";
    }
    echo "<br>";
} catch (PDOException $e) {
    echo "Error (READ one): " . htmlspecialchars($e->getMessage()) . "<br><br>";
}
```

---

## UPDATE - Modify existing student record

```php
echo "<h2>UPDATE - Updating Student</h2>";

try {
    $update_id = 1;
    $new_name  = "Alice Johnson Updated";
    $new_age   = 23;
    $new_major = "Computer Engineering";

    $sql  = "UPDATE students
             SET name = :name, age = :age, major = :major
             WHERE id = :id";
    $stmt = $pdo->prepare($sql);
    $stmt->execute([
        ':name'  => $new_name,
        ':age'   => $new_age,
        ':major' => $new_major,
        ':id'    => $update_id,
    ]);

    if ($stmt->rowCount() > 0) {
        echo "Student with ID {$update_id} updated successfully<br>";
    } else {
        // Note: rowCount can be 0 if values are identical
        echo "No changes made (or student not found).<br>";
    }
} catch (PDOException $e) {
    echo "Error (UPDATE): " . htmlspecialchars($e->getMessage()) . "<br><br>";
}
```

---

## DELETE - Remove a student record

```php
echo "<h2>DELETE - Removing Student</h2>";

try {
    $delete_id = 2;
    $sql  = "DELETE FROM students WHERE id = :id";
    $stmt = $pdo->prepare($sql);
    $stmt->execute([':id' => $delete_id]);

    if ($stmt->rowCount() > 0) {
        echo "Student with ID {$delete_id} deleted successfully<br>";
    } else {
        echo "No student found with ID {$delete_id}<br>";
    }
    echo "<br>";
} catch (PDOException $e) {
    echo "Error (DELETE): " . htmlspecialchars($e->getMessage()) . "<br><br>";
}
```
